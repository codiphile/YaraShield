// Advanced malware detection rules
rule Ransomware_Detector {
    meta:
        name = "CryptoLocker"
        description = "Detects CryptoLocker ransomware patterns"
        author = "Mudit Sharma"
        date = "2024-03-01"
        severity = "Critical"
    strings:
        $s1 = "GANDCRAB" nocase
        $s2 = "Encrypting your files" nocase
        $s3 = "Your files have been encrypted" nocase
        $s4 = ".crypto" nocase
        $s5 = "bitcoin" nocase
        $hex_pattern = { 6A 40 68 00 30 00 00 6A 14 8D 91 }
    condition:
        2 of them
}

rule PowerShell_Attack {
    meta:
        name = "PowerShell_Backdoor"
        description = "Detects suspicious PowerShell patterns"
        author = "Mudit Sharma"
        date = "2024-03-01"
        severity = "High"
    strings:
        $ps1 = "-EncodedCommand" nocase
        $ps2 = "Invoke-Expression" nocase
        $ps3 = "Invoke-WebRequest" nocase
        $ps4 = "Invoke-RestMethod" nocase
        $ps5 = "DownloadString" nocase
        $ps6 = "DownloadFile" nocase
        $ps7 = "Net.WebClient" nocase
        $ps8 = "ScriptBlock.Create" nocase
    condition:
        2 of them
}

rule Obfuscated_JS {
    meta:
        name = "JS_Obfuscator"
        description = "Detects obfuscated JavaScript code"
        author = "Mudit Sharma"
        date = "2024-03-01"
        severity = "Medium"
    strings:
        $eval = "eval(" nocase
        $chars = "fromCharCode" nocase
        $unescape = "unescape(" nocase
        $decode = "decodeURIComponent" nocase
        $encode = "encodeURIComponent" nocase
        $base64 = "base64" nocase
        $atob = "atob(" nocase
        $btoa = "btoa(" nocase
        $obfuscator1 = "var _0x" nocase
        $obfuscator2 = "function _0x" nocase
    condition:
        3 of them
}